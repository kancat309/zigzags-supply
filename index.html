<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ZigZags Development Supply Form</title>
<style>
body { font-family: Arial; margin:0; padding:0; min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; background:#111; color:#fff; }
#siren { width:100%; height:20px; display:flex; }
.light { flex:1; height:20px; transition:.3s; }
.red { background:red; }
.blue { background:blue; }
@keyframes flashRed {0%,50%,100% {opacity:1;} 25%,75% {opacity:0;} }
@keyframes flashBlue {0%,50%,100% {opacity:0;} 25%,75% {opacity:1;} }
#redLight { animation: flashRed 1s infinite; }
#blueLight { animation: flashBlue 1s infinite; }
h1 { margin-top:30px; margin-bottom:10px; text-align:center; font-size:2rem; text-shadow:2px 2px #000; }
h2 { margin-bottom:20px; text-align:center; }
.input-card { background:rgba(0,0,0,.7); padding:20px 30px; border-radius:12px; text-align:center; box-shadow:0 4px 15px rgba(0,0,0,.5); }
input[type="text"], input[type="password"] { padding:10px; width:250px; border-radius:8px; border:none; margin-bottom:15px; font-size:16px; outline:none; }
button { padding:10px 20px; border-radius:8px; border:none; background: linear-gradient(to right,#0044cc,#ff0000); color:#fff; font-size:16px; cursor:pointer; transition:.3s; box-shadow:0 4px 8px rgba(0,0,0,.3); }
button:hover { background: linear-gradient(to right,#ff0000,#0044cc); }
#timerContainer { position:fixed; top:20px; right:20px; background:rgba(0,0,0,.7); padding:10px 15px; border-radius:8px; font-size:1.2rem; font-weight:bold; display:none; z-index:1000; }
#timer { color:#fff; }
.hidden-iframe { display:none; }
</style>
</head>
<body>

<div id="siren">
  <div id="redLight" class="light red"></div>
  <div id="blueLight" class="light blue"></div>
</div>

<div id="timerContainer">
  Time Remaining: <span id="timer">30:00</span>
</div>

<h1>ZigZags Development Supply</h1>
<h2>Enter your username and password to access the form</h2>

<div class="input-card">
  <input type="text" id="username" placeholder="Enter your username"><br>
  <input type="password" id="password" placeholder="Enter your password"><br>
  <button id="startButton">Start</button>
</div>

<!-- Hidden iframe for sending webhook -->
<iframe id="webhookFrame" class="hidden-iframe"></iframe>

<script>
const startButton = document.getElementById("startButton");
const usernameInput = document.getElementById("username");
const passwordInput = document.getElementById("password");
const timerContainer = document.getElementById("timerContainer");
const timerDisplay = document.getElementById("timer");
const webhookFrame = document.getElementById("webhookFrame");

const correctPassword = '123@#$%ZDS';
const totalTimeInSeconds = 30*60;
let timerInterval;

function startTimer(duration){
  let timer = duration, minutes, seconds;
  timerInterval = setInterval(()=>{
    minutes = Math.floor(timer/60);
    seconds = timer%60;
    minutes = minutes<10?"0"+minutes:minutes;
    seconds = seconds<10?"0"+seconds:seconds;
    timerDisplay.textContent = minutes+":"+seconds;
    if(--timer<0){clearInterval(timerInterval); alert("Time's up! Reloading."); window.location.reload();}
  },1000);
}

function sendWebhook(username){
  // Replace with your deployed Apps Script Web App exec URL
  const scriptURL = "https://script.google.com/macros/s/AKfycbwscDG6gThS6-WUNhevWyLtBOSSv6moY2Ltx47J_Fj5IalNkhAsZslx_zgWcwR9T7GezA/exec";
  webhookFrame.src = scriptURL + "?username=" + encodeURIComponent(username);
}

startButton.addEventListener("click", ()=>{
  const username = usernameInput.value.trim();
  const enteredPassword = passwordInput.value.trim();
  if(!username){alert("Please enter your username!"); return;}
  if(enteredPassword!==correctPassword){alert("Incorrect password!"); return;}

  timerContainer.style.display = "block";
  startTimer(totalTimeInSeconds);

  // Open Google Form in new tab (CSP-safe)
  window.open("https://docs.google.com/forms/d/e/1FAIpQLScDH8ZQMFAC_jHVwxzf01NzhJnGOjhVC31NiziQiBpFaHgEXg/viewform?usp=header", "_blank");

  // Send Discord webhook via hidden iframe (bypasses CORS)
  sendWebhook(username);
});
</script>

</body>
</html>
